{% extends 'partials/base2.html' %}
{% block title %}Add Card{% endblock %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}

<style>
    .flip-card {
        background-color: transparent;
        width: 240px;
        height: 154px;
        perspective: 1000px;
        color: white;
    }

    .heading_8264 {
        position: absolute;
        letter-spacing: .2em;
        font-size: 0.5em;
        top: 2em;
        left: 18.6em;
    }

    .logo {
        position: absolute;
        top: 6.8em;
        left: 11.7em;
    }

    .chip {
        position: absolute;
        top: 2.3em;
        left: 1.5em;
    }

    .contactless {
        position: absolute;
        top: 3.5em;
        left: 12.4em;
    }

    .number {
        position: absolute;
        font-weight: bold;
        font-size: .6em;
        top: 8.3em;
        left: 1.6em;
    }

    .valid_thru {
        position: absolute;
        font-weight: bold;
        top: 635.8em;
        font-size: .01em;
        left: 140.3em;
    }

    .date_8264 {
        position: absolute;
        font-weight: bold;
        font-size: 0.5em;
        top: 13.6em;
        left: 3.2em;
    }

    .name {
        position: absolute;
        font-weight: bold;
        font-size: 0.5em;
        top: 16.1em;
        left: 2em;
    }

    .strip {
        position: absolute;
        background-color: black;
        width: 15em;
        height: 1.5em;
        top: 2.4em;
        background: repeating-linear-gradient(45deg,
                #303030,
                #303030 10px,
                #202020 10px,
                #202020 20px);
    }

    .mstrip {
        position: absolute;
        background-color: rgb(255, 255, 255);
        width: 8em;
        height: 0.8em;
        top: 5em;
        left: .8em;
        border-radius: 2.5px;
    }

    .sstrip {
        position: absolute;
        background-color: rgb(255, 255, 255);
        width: 4.1em;
        height: 0.8em;
        top: 5em;
        left: 10em;
        border-radius: 2.5px;
    }

    .code {
        font-weight: bold;
        text-align: center;
        margin: .2em;
        color: black;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .flip-card:hover .flip-card-inner {
        transform: rotateY(180deg);
    }

    .flip-card-front,
    .flip-card-back {
        box-shadow: 0 8px 14px 0 rgba(0, 0, 0, 0.2);
        position: absolute;
        display: flex;
        flex-direction: column;
        justify-content: center;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: 1rem;
    }

    .flip-card-front {
        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -1px 0px inset;
        background-color: #171717;
    }

    .flip-card-back {
        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 2px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -1px 0px inset;
        background-color: #171717;
        transform: rotateY(180deg);
    }

    /* From Uiverse.io by JohnnyCSilva */
    .card {
        width: 195px;
        height: 285px;
        background: #313131;
        border-radius: 20px;
        ;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        transition: 0.2s ease-in-out;
    }

    .img {
        height: 30%;
        position: absolute;
        transition: 0.2s ease-in-out;
        z-index: 1;
    }

    .textBox {
        opacity: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 15px;
        transition: 0.2s ease-in-out;
        z-index: 2;
    }

    .textBox>.text {
        font-weight: bold;
    }

    .textBox>.head {
        font-size: 20px;
    }

    .textBox>.price {
        font-size: 17px;
    }

    .textBox>span {
        font-size: 12px;
        color: lightgrey;
    }

    .card:hover>.textBox {
        opacity: 1;
    }

    .card:hover>.img {
        height: 65%;
        filter: blur(7px);
        animation: anim 3s infinite;
    }

    @keyframes anim {
        0% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-20px);
        }

        100% {
            transform: translateY(0);
        }
    }

    .card:hover {
        transform: scale(1.04) rotate(-1deg);
    }
</style>




<div class="bg-white p-8 rounded-lg shadow-md w-96">
    <div class="d-flex justify-content-center flex-column align-items-center">

        </p>
        <br>
        <div class="flip-card" data-aos="flip-up" data-aos-duration="2000">
            <div class="flip-card-inner">
                <div class="flip-card-front">
                    <p class="heading_8264 text-warning font-bold">OffShore</p>

                    <svg version="1.1" class="chip" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="30px"
                        viewBox="0 0 50 50" xml:space="preserve">
                        <image id="image0" width="50" height="50" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                      AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB6VBMVEUAAACNcTiVeUKVeUOY
                      fEaafEeUeUSYfEWZfEaykleyklaXe0SWekSZZjOYfEWYe0WXfUWXe0WcgEicfkiXe0SVekSXekSW
                      ekKYe0a9nF67m12ZfUWUeEaXfESVekOdgEmVeUWWekSniU+VeUKVeUOrjFKYfEWliE6WeESZe0GS
                      e0WYfES7ml2Xe0WXeESUeEOWfEWcf0eWfESXe0SXfEWYekSVeUKXfEWxklawkVaZfEWWekOUekOW
                      ekSYfESZe0eXekWYfEWZe0WZe0eVeUSWeETAnmDCoWLJpmbxy4P1zoXwyoLIpWbjvXjivnjgu3bf
                      u3beunWvkFWxkle/nmDivXiWekTnwXvkwHrCoWOuj1SXe0TEo2TDo2PlwHratnKZfEbQrWvPrWua
                      fUfbt3PJp2agg0v0zYX0zYSfgkvKp2frxX7mwHrlv3rsxn/yzIPgvHfduXWXe0XuyIDzzISsjVO1
                      lVm0lFitjVPzzIPqxX7duna0lVncuHTLqGjvyIHeuXXxyYGZfUayk1iyk1e2lln1zYTEomO2llrb
                      tnOafkjFpGSbfkfZtXLhvHfkv3nqxH3mwXujhU3KqWizlFilh06khk2fgkqsjlPHpWXJp2erjVOh
                      g0yWe0SliE+XekShhEvAn2D///+gx8TWAAAARnRSTlMACVCTtsRl7Pv7+vxkBab7pZv5+ZlL/UnU
                      /f3SJCVe+Fx39naA9/75XSMh0/3SSkia+pil/KRj7Pr662JPkrbP7OLQ0JFOijI1MwAAAAFiS0dE
                      orDd34wAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IDx2lsiuJAAACLElEQVRIx2Ng
                      GAXkAUYmZhZWPICFmYkRVQcbOwenmzse4MbFzc6DpIGXj8PD04sA8PbhF+CFaxEU8iWkAQT8hEVg
                      OkTF/InR4eUVICYO1SIhCRMLDAoKDvFDVhUaEhwUFAjjSUlDdMiEhcOEItzdI6OiYxA6YqODIt3d
                      I2DcuDBZsBY5eVTr4xMSYcyk5BRUOXkFsBZFJTQnp6alQxgZmVloUkrKYC0qqmji2WE5EEZuWB6a
                      lKoKdi35YQUQRkFYPpFaCouKIYzi6EDitJSUlsGY5RWVRGjJLyxNy4ZxqtIqqvOxaVELQwZFZdkI
                      JVU1RSiSalAt6rUwUBdWG1CP6pT6gNqwOrgCdQyHNYR5YQFhDXj8MiK1IAeyN6aORiyBjByVTc0F
                      qBoKWpqwRCVSgilOaY2OaUPw29qjOzqLvTAchpos47u6EZyYnngUSRwpuTe6D+6qaFQdOPNLRzOM
                      1dzhRZyW+CZouHk3dWLXglFcFIflQhj9YWjJGlZcaKAVSvjyPrRQ0oQVKDAQHlYFYUwIm4gqExGm
                      BSkutaVQJeomwViTJqPK6OhCy2Q9sQBk8cY0DxjTJw0lAQWK6cOKfgNhpKK7ZMpUeF3jPa28BCET
                      amiEqJKM+X1gxvWXpoUjVIVPnwErw71nmpgiqiQGBjNzbgs3j1nus+fMndc+Cwm0T52/oNR9lsdC
                      S24ra7Tq1cbWjpXV3sHRCb1idXZ0sGdltXNxRateRwHRAACYHutzk/2I5QAAACV0RVh0ZGF0ZTpj
                      cmVhdGUAMjAyMy0wMi0xM1QwODoxNToyOSswMDowMEUnN7UAAAAldEVYdGRhdGU6bW9kaWZ5ADIw
                      MjMtMDItMTNUMDg6MTU6MjkrMDA6MDA0eo8JAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAy
                      LTEzVDA4OjE1OjI5KzAwOjAwY2+u1gAAAABJRU5ErkJggg=="></image>
                    </svg>
                    <svg version="1.1" class="contactless" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px"
                        viewBox="0 0 50 50" xml:space="preserve">
                        <image id="image0" width="50" height="50" x="0" y="0" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAQAAAC0NkA6AAAABGdBTUEAALGPC/xhBQAAACBjSFJN
                      AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZ
                      cwAACxMAAAsTAQCanBgAAAAHdElNRQfnAg0IEzgIwaKTAAADDklEQVRYw+1XS0iUURQ+f5qPyjQf
                      lGRFEEFK76koKGxRbWyVVLSOgsCgwjZBJJYuKogSIoOonUK4q3U0WVBWFPZYiIE6kuArG3VGzK/F
                      fPeMM/MLt99/NuHdfPd888/57jn3nvsQWWj/VcMlvMMd5KRTogqx9iCdIjUUmcGR9ImUYowyP3xN
                      GQJoRLVaZ2DaZf8kyjEJALhI28ELioyiwC+Rc3QZwRYyO/DH51hQgWm6DMIh10KmD4u9O16K49it
                      VoPOAmcGAWWOepXIRScAoJZ2Frro8oN+EyTT6lWkkg6msZfMSR35QTJmjU0g15tIGSJ08ZZMJkJk
                      HpNZgSkyXosS13TkJpZ62mPIJvOSzC1bp8vRhhCakEk7G9/o4gmZdbpsTcKu0m63FbnBP9Qrc15z
                      bkbemfgNDtEOI8NO5L5O9VYyRYgmJayZ9nPaxZrSjW4+F6Uw9yQqIiIZwhp2huQTf6OIvCZyGM6g
                      DJBZbyXifJXr7FZjGXsdxADxI7HUJFB6iWvsIhFpkoiIiGTJfjJfiCuJg2ZEspq9EHGVpYgzKqwJ
                      qSAOEwuJQ/pxPvE3cYltJCLdxBLiSKKIE5HxJKcTRNeadxfhDiuYw44zVs1dxKwRk/uCxIiQkxKB
                      sSctRVAge9g1E15EHE6yRUaJecRxcWlukdRIbGFOSZCMWQA/iWauIP3slREHXPyliqBcrrD71Amz
                      Z+rD1Mt2Yr8TZc/UR4/YtFnbijnHi3UrN9vKQ9rPaJf867ZiaqDB+czeKYmd3pNa6fuI75MiC0uX
                      XSR5aEMf7s7a6r/PudVXkjFb/SsrCRfROk0Fx6+H1i9kkTGn/E1vEmt1m089fh+RKdQ5O+xNJPUi
                      cUIjO0Dm7HwvErEr0YxeibL1StSh37STafE4I7zcBdRq1DiOkdmlTJVnkQTBTS7X1FYyvfO4piaI
                      nKbDCDaT2anLudYXCRFsQBgAcIF2/Okwgvz5+Z4tsw118dzruvIvjhTB+HOuWy8UvovEH6beitBK
                      xDyxm9MmISKCWrzB7bSlaqGlsf0FC0gMjzTg6GgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDIt
                      MTNUMDg6MTk6NTYrMDA6MDCjlq7LAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAyLTEzVDA4OjE5
                      OjU2KzAwOjAw0ssWdwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMi0xM1QwODoxOTo1Nisw
                      MDowMIXeN6gAAAAASUVORK5CYII="></image>
                    </svg>
                    <p class="number">9759 2484 5269 6576</p>
                    <p class="valid_thru">VALID THRU</p>
                    <p class="date_8264">1 2 / 2 4</p>
                    <p class="name">MIRIAM MERINHO</p>
                </div>
                <div class="flip-card-back">
                    <div class="strip"></div>
                    <div class="mstrip"></div>
                    <div class="sstrip">
                        <p class="code">***</p>
                    </div>
                </div>
            </div>
        </div>
        <br>

    </div>
    <br><br>


    <h6 class="h6 font-bold">Payment Details</h6>
    <div class="flex bg-primary-subtle border border-warning-subtle border-2 p-2 rounded-md flex-col">
        <p>
            Outstanding: <span class="text-primary font-bold">$15,183.54</span> out of
            <span class="text-primary font-bold">$60,754</span>.
            Want to pay installmentally?
            <a href="{% url 'userauths:payment_plans' %}" target="_blank" class="text-primary font-bold">
                Click here <span class="i bx bx-link"></span>
            </a>
            to view a list of payment plans.
        </p>
    </div>
    <br>
    <div class="text-center">
        <h2 class="text-2xl font-bold text-center">Resolve My Account </h2><span
            class="badge bg-dark text-white">20%</span>
    </div>


    <p class="text-blue-400 items-center justify-center flex">
        <span>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="size-5 mx-2">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
            </svg>
        </span>
        Powered by Stripe.
    </p>
    <br>

    <div class="space-y-4">
        <!-- Accordion Item 1: Pay with Gift Card -->
        <div class="accordion-item border border-gray-200 rounded-md">
            <button type="button"
                class="accordion-button flex items-center justify-between w-full p-4 text-left bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                <span class="text-lg font-medium text-gray-700">Pay with Gift Card</span>
                <i class='bx bx-chevron-down text-2xl text-gray-500 transition-transform duration-200'></i>
            </button>
            <div class="accordion-content hidden p-4 bg-white">
                <small class="text-primary">Ensure the gift card amount matches the payment plan amount.</small>
                <form method="post" enctype="multipart/form-data" class="space-y-4" id="credit-card-form">
                    {% csrf_token %}
                    {{ form|crispy }}
                    <button type="submit"
                        class="w-full bg-indigo-500 text-white py-2 px-4 rounded-lg hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed"
                        id="submit-button" disabled>
                        Submit
                    </button>
                </form>
            </div>
        </div>

        <!-- Accordion Item 2: Pay with Bitcoin BTC -->
        <div class="accordion-item border border-gray-200 rounded-md">
            <button type="button"
                class="accordion-button flex items-center justify-between w-full p-4 text-left bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                <span class="text-lg font-medium text-gray-700">Pay with Bitcoin BTC</span>
                <i class='bx bx-chevron-down text-2xl text-gray-500 transition-transform duration-200'></i>
            </button>
            <div class="accordion-content hidden p-4 bg-gray-100">
                <p class="text-center mb-6 text-warning">Powered by Binance.</p>
                <div class="flex flex-col items-center">
                    <i>Scan to pay</i>
                    <img src="{% static 'shop_media/BTC.jpg' %}" alt="Bitcoin Payment QR Code"
                        class="w-32 h-32 object-cover">
                    <br>
                    <i>Or</i>
                    <h6 class="h6 fw-bold text-primary" id="copyTextBTC">1Kqjt8SDJ2PYMxoEfLyPDPcYcx4zhURoGY</h6>
                    <button id="copyButtonBTC" class="bg-blue-50 rounded-3 text-primary w-48 px-3 py-2">
                        <i class='bx bx-copy-alt'></i> Copy address
                    </button>
                </div>
            </div>
        </div>

        <!-- Accordion Item 3: Pay with Bitcoin Cash BCH -->
        <div class="accordion-item border border-gray-200 rounded-md">
            <button type="button"
                class="accordion-button flex items-center justify-between w-full p-4 text-left bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                <span class="text-lg font-medium text-gray-700">Pay with Bitcoin Cash BCH</span>
                <i class='bx bx-chevron-down text-2xl text-gray-500 transition-transform duration-200'></i>
            </button>
            <div class="accordion-content hidden p-4 bg-gray-100">
                <p class="text-center mb-6 text-warning">Powered by Binance.</p>
                <div class="flex flex-col items-center">
                    <i>Scan to pay</i>
                    <img src="{% static 'shop_media/BCH.jpg' %}" alt="Bitcoin Cash Payment QR Code"
                        class="w-32 h-32 object-cover">
                    <br>
                    <i>Or</i>
                    <h6 class="h6 fw-bold text-primary" id="copyTextBCH">1Q7A54LXGA4sQotxgSoGzBKzkbEATFthUw</h6>
                    <button id="copyButtonBCH" class="bg-blue-50 rounded-3 text-primary w-48 px-3 py-2">
                        <i class='bx bx-copy-alt'></i> Copy address
                    </button>
                </div>
            </div>
        </div>

        <!-- Optional: Additional Accordion Items -->

        <!-- Open the modal using ID.showModal() method -->
        <dialog id="my_modal_1" class="modal">
            <div class="modal-box">
                <h3 class="text-lg font-bold">Feedback</h3>
                <p class="py-4 text-center text-4xl"><i class='bx bx-check-circle'></i></p>
                <p class="text-center">We will review your details and update your account accordingly.</p>
                <small class="text-primary text-center">Do not close this page yet.</small>

                <div class="modal-action">
                    <form method="dialog">
                        <!-- if there is a button in form, it will close the modal -->
                        <button class="btn">Ok</button>
                    </form>
                </div>
            </div>
        </dialog>
        <!-- Payment Confirmation Section -->


        <div class="bg-gray-100 flex items-center justify-center p-4 rounded-md">
            <div class="bg-white p-6 rounded-lg shadow-md w-full">
                <div class="flex flex-col my-3">
                    <div class="mb-4">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" id="paymentCheckbox" class="form-checkbox h-5 w-5 text-blue-600">
                            <span class="ml-2 text-gray-700">
                                I have made payments for <span class="text-blue-600 font-bold">BTC</span>.
                            </span>
                        </label>
                    </div>
                    <button id="finishButton" onclick="my_modal_1.showModal()"
                        class="btn bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        Finish
                    </button>
                </div>
            </div>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="mt-4 text-green-600 text-center hidden">
            Card added successfully!
        </div>
    </div>
    <div class="container flex justify-center">
        <img src="{% static 'shop_media/Card Page.svg' %}" alt="Card Page" data-aos="flip-up" data-aos-duration="2000">
    </div>
    <br>
</div>

<!-- JavaScript for Accordion and Other Functionalities -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Accordion Functionality
        const accordionItems = document.querySelectorAll('.accordion-item');

        accordionItems.forEach(item => {
            const button = item.querySelector('.accordion-button');
            const content = item.querySelector('.accordion-content');
            const icon = button.querySelector('i');

            button.addEventListener('click', () => {
                // Toggle the hidden class on the content
                content.classList.toggle('hidden');

                // Toggle the chevron icon
                icon.classList.toggle('bx-chevron-up');
                icon.classList.toggle('bx-chevron-down');
            });
        });

        // Copy to Clipboard Functionality
        const copyToClipboard = (text, button) => {
            navigator.clipboard.writeText(text)
                .then(() => {
                    // Temporarily change button text to indicate success
                    const originalHTML = button.innerHTML;
                    button.innerHTML = '<i class="bx bx-check"></i> Copied!';
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                    }, 2000);
                })
                .catch(() => {
                    // Indicate failure
                    const originalHTML = button.innerHTML;
                    button.innerHTML = '<i class="bx bx-error"></i> Failed!';
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                    }, 2000);
                });
        };

        // Event Listeners for Copy Buttons
        const copyButtons = document.querySelectorAll('[id^="copyButton"]');
        copyButtons.forEach(button => {
            button.addEventListener('click', function () {
                const targetId = this.id.replace('copyButton', 'copyText');
                const textToCopy = document.getElementById(targetId).innerText;
                copyToClipboard(textToCopy, this);
            });
        });

        // Form Validation for Credit Card Form
        const form = document.getElementById("credit-card-form");
        const submitButton = document.getElementById("submit-button");

        if (form && submitButton) {
            const toggleSubmitButton = () => {
                const allFieldsFilled = Array.from(form.querySelectorAll("input, select, textarea")).every(input => {
                    // For checkboxes and radio buttons, check if they are checked
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        return input.checked;
                    }
                    return input.value.trim() !== "";
                });
                submitButton.disabled = !allFieldsFilled;
            };

            // Initial check
            toggleSubmitButton();

            // Add event listeners to form inputs
            form.addEventListener("input", toggleSubmitButton);
        }

        // Payment Checkbox and Finish Button Functionality
        const paymentCheckbox = document.getElementById('paymentCheckbox');
        const finishButton = document.getElementById('finishButton');

        if (paymentCheckbox && finishButton) {
            paymentCheckbox.addEventListener('change', function () {
                finishButton.disabled = !this.checked;
            });
        }
    });
</script>
{% endblock content %}